import numpy as np
import matplotlib.pyplot as plt


#x = np.zeros(25) # time elasped 

x = np.zeros(25)

for i in range(25): 
    x[i] = i 

k = 0.09 # 0.09 - 0.33 per h; is changeable; elimination 
bio_acc = 1 # more needed
caf_drink = 100 # in mg 
A_o = bio_acc*caf_drink
blood = 7 # liters 
half_life = 4; 
k_bt = 0.1 # blood to brain not actual values 
k_tb = 0.1 # blood to brain see if equal 
k_meta = 0.5
k_absg = 1 


time_max = 24 # hours 
rBlood = 100
rTissue = 0 # 

A_blood_iEuler = np.zeros(25) # amount of caffiene in mg of blood and brain compartement, will be filled by solver 
dA_blood_iEuler = np.zeros(25)
A_gut_iEuler = np.zeros(25)
A_gut_iEuler[0] = A_o
A_t_iEuler = np.zeros(25)
dA_t_iEuler = np.zeros(25)
step = 1 




'''. 

current model: 3 compartment (gut included, just recieves A_o of caffeine)

eq'n: 



'''



# are we gonna do RK4 method 
#solver improved Euler 

def gut_derive(A_gut): 
   global k_absg
   return -k_absg*A_gut

def bld_deriv(Abld, Ag): 
   global k_absg, k_bt
   return k_absg*Ag -(k_bt +k_meta)*Abld

for i in range(1, 25): 
   dgut_n = gut_derive(A_gut_iEuler[i-1])
   dummyg = A_gut_iEuler[i-1] + step*dgut_n
   dgut_next = gut_derive(dummyg)
   if dgut_next > 0: 
      A_gut_iEuler[i] = 0
      continue
   A_gut_iEuler[i] = A_gut_iEuler[i-1] + 0.5*step*(dgut_next + dgut_n) 

# blood stuff 
   
for count in range(1,25): 
   dbld_n = bld_deriv(A_blood_iEuler[count-1], A_gut_iEuler[count-1])
   dummybld = A_blood_iEuler[count-1] + step*dbld_n
   dbld_next = bld_deriv(dummybld,A_gut_iEuler[count])
   A_blood_iEuler[count] = A_blood_iEuler[count-1] +0.5*step*(dbld_n+dbld_next)

# Tissue 


# code for plotting 

plt.minorticks_on()
plt.plot(x,A_blood_iEuler)
plt.show()



#plt.imsave('graph.png')



